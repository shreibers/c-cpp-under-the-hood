#include "polymorpism.h"#include "stdio.h"#include <stdlib.h>void doPrePostFixer(){    PrePostFixer angleBrackets;    printf("\n--- start doPrePostFixer() ---\n\n");    _ZN12PrePostFixerC1ERKS_(&angleBrackets, "<<< ", " >>>");    _ZNK12PrePostFixer5printEPKc(&angleBrackets, "Hello World!");    printf("%-60s | ","[PrePostFixer::print(long, char)]");    printf("-->\n");    printf("%-60s | ", "[PrePostFixer::print_num(long)]");    printf("%s%ld%s\n", ((PrePostFixer*)&angleBrackets)->_pre, (long)-777, ((PrePostFixer*)&angleBrackets)->_post);    printf("%-60s | ","[PrePostFixer::print_num(long, char)]");    printf("%s%c%ld%s\n", ((PrePostFixer*)&angleBrackets)->_pre, '#', (long)350, ((PrePostFixer*)&angleBrackets)->_post);    printf("%-60s | ", "[PrePostFixer::print_num(long)]");    printf("%s%ld%s\n", ((PrePostFixer*)&angleBrackets)->_pre, (long)3, ((PrePostFixer*)&angleBrackets)->_post);    printf("\n--- end doPrePostFixer() ---\n\n");    ((typeDtor)(((TextFormatter*)&angleBrackets)->vPtr)[E_Dtor])(&angleBrackets);}void doPrePostDollarFixer() {    PrePostDollarFixer asterisks;    printf("\n--- start doPrePostDollarFixer() ---\n\n");    _ZN18PrePostDollarFixerCERKS_(&asterisks, "***** ", " *****");    _ZN18PrePostDollarFixer5printEic(&asterisks, -777, '$');    _ZN18PrePostDollarFixer5printEic(&asterisks, 350, '#');    _ZN18PrePostDollarFixer5printEdc(&asterisks, 3.14f, '$');    printf("\n--- end doPrePostDollarFixer() ---\n\n");    ((typeDtor)(((TextFormatter*)&asterisks)->vPtr)[E_Dtor])(&asterisks);}void doPrePostChecker(){    PrePostChecker check;    printf("\n--- start doPrePostChecker() ---\n\n");    _ZN14PrePostCheckerCEv(&check);    _ZNK14PrePostChecker24printThisSymbolUsingFuncEv(&check);    _ZNK14PrePostChecker23printThisSymbolDirectlyEv(&check);    _ZNK14PrePostChecker31printDollarSymbolByCastDirectlyEv(&check);    _ZN14PrePostChecker24printDollarSymbolByScopeDirectlyEv(&check);    _ZN14PrePostChecker24printDollarSymbolByCastUsingFuncEv(&check);    _ZN14PrePostChecker24printDollarSymbolByScopeUsingFuncEv(&check);    printf("\n--- end doPrePostChecker() ---\n\n");    ((typeDtor)(((TextFormatter*)&check)->vPtr)[E_Dtor])(&check);}void doPrePostFloatDollarFixer(){    PrePostFloatDollarFixer hashes;    PrePostDollarFixer hashes2;    printf("\n--- start doPrePostFloatDollarFixer() ---\n\n");    _ZN18PrePostFloatDollarFixerCEcc(&hashes,"### ", " ###");    _ZN23PrePostFloatDollarFixer5printEf(&hashes, -777);    _ZNK23PrePostFloatDollarFixer5printEfc(&hashes, 350, '#');    _ZN23PrePostFloatDollarFixer5printEf(&hashes, 3.14f);    _ZN18PrePostDollarFixerCEPKcS(&hashes2, (PrePostDollarFixer *) &hashes);    _ZN18PrePostDollarFixer5printEdc(&hashes2, 7.5, '$');    _ZN18PrePostDollarFixer5printEic(&hashes2, 100, '$');    printf("\n--- start doPrePostFloatDollarFixer() ---\n\n");    ((typeDtor)(((TextFormatter*)&hashes2)->vPtr)[E_Dtor])(&hashes2);    ((typeDtor)(((TextFormatter*)&hashes)->vPtr)[E_Dtor])(&hashes);}void runAsPrePostFixerRef(const PrePostFixer* pp){    printf("\n--- start runAsPrePostFixerRef() ---\n\n");    ((typeFuncPrintLongChar)(((TextFormatter*)pp)->vPtr)[E_PrintELongAndChar])(pp, 123, '\0');    printf("\n--- end runAsPrePostFixerRef() ---\n\n");}void runAsPrePostDollarFixerRef(const PrePostDollarFixer* pp){printf("\n--- start runAsPrePostDollarFixerRef() ---\n\n");_ZN18PrePostDollarFixer5printEic(pp, 123, '$');printf("\n--- end runAsPrePostDollarFixerRef() ---\n\n");}void runAsPrePostDollarFixerObj(const PrePostDollarFixer pp){    printf("\n--- start runAsPrePostDollarFixerObj() ---\n\n");    _ZN18PrePostDollarFixer5printEic(&pp, 123, '$');    printf("\n--- end runAsPrePostDollarFixerObj() ---\n\n");}void runAsPrePostHashFixerRef(const PrePostHashFixer* pp){    printf("\n--- start runAsPrePostHashFixerRef() ---\n\n");    _ZN16PrePostHashFixer5printEic(pp, 123, '#');    printf("\n--- end runAsPrePostHashFixerRef() ---\n\n");}void doMultiplier(){    Multiplier m1, m2, m3, m4;    printf("\n--- start doMultiplier() ---\n\n");    _ZN20DefaultTextFormatterCEv((DefaultTextFormatter*)&m1);    ((TextFormatter*)&m1)->vPtr = arrayOfVirtFunctionsStructMultiplier;    m1._times = 3;    printf("--- Multiplier CTOR: times = %d\n", m1._times);    _ZN20DefaultTextFormatterCEv((DefaultTextFormatter*)&m2);    ((TextFormatter*)&m2)->vPtr = arrayOfVirtFunctionsStructMultiplier;    m2._times = 5;    printf("--- Multiplier CTOR: times = %d\n", m2._times);    _ZN10MultiplierC1ERKS_(&m3, &m1);    _ZN10MultiplierC1ERKS_(&m4, &m2);    _ZNK10Multiplier5printEPKc(&m1, "abc ");    _ZNK10Multiplier5printEPKc(&m2, "abc ");    _ZNK10Multiplier5printEPKc(&m3, "abc ");    _ZNK10Multiplier5printEPKc(&m4, "abc ");    printf("\n--- start doMultiplier() ---\n\n");}void doFormatterArray(){    PrePostDollarFixer prePostF;    Multiplier multi;    PrePostChecker prePostC;    int i = 0;    DefaultTextFormatter formatters[3], obj1, obj2, obj3;    printf("\n--- start doFormatterArray() ---\n\n");    _ZN18PrePostDollarFixerCERKS_(&prePostF, "!!! ", " !!!");    _ZN23PrePostFloatDollarFixerCEPKcS_(&obj1, (DefaultTextFormatter *) &prePostF);    ((typeDtor)(((TextFormatter*)&prePostF)->vPtr)[E_Dtor])(&prePostF);    _ZN20DefaultTextFormatterCEv((DefaultTextFormatter*)&multi);    ((TextFormatter*)&multi)->vPtr = arrayOfVirtFunctionsStructMultiplier;    multi._times = 4;    printf("--- Multiplier CTOR: times = %d\n", multi._times);    _ZN23PrePostFloatDollarFixerCEPKcS_(&obj2, (DefaultTextFormatter *) &multi);        printf("--- Multiplier DTOR: times = %d\n", ((Multiplier*)&multi)->_times);    ((TextFormatter*)&multi)->vPtr = arrayOfVirtFunctionsStructDefaultTextFormatter;    ((typeDtor)(((TextFormatter*)&multi)->vPtr)[E_Dtor])(&multi);    _ZN14PrePostCheckerCEv(&prePostC);    _ZN23PrePostFloatDollarFixerCEPKcS_(&obj3, (DefaultTextFormatter *) &prePostC);    ((typeDtor)(((TextFormatter*)&prePostC)->vPtr)[E_Dtor])(&prePostC);    formatters[0] = obj1;    formatters[1] = obj2;    formatters[2] = obj3;    for (; i < 3; ++i)        _ZN13DefaultTextFormatter5printEc(&formatters[i], "Hello World!");    printf("\n--- end doFormatterArray() ---\n\n");    ((typeDtor)(((TextFormatter*)&obj3)->vPtr)[E_Dtor])(&obj3);    ((typeDtor)(((TextFormatter*)&obj2)->vPtr)[E_Dtor])(&obj2);    ((typeDtor)(((TextFormatter*)&obj1)->vPtr)[E_Dtor])(&obj1);    ((typeDtor)(((TextFormatter*)&formatters)->vPtr)[E_Dtor])(&formatters);}void doFormatterPtrs(){    DefaultTextFormatter* pfmt[3];    int i;    printf("\n--- start doFormatterPtrs() ---\n\n");    pfmt[0] = malloc(sizeof(PrePostDollarFixer));    _ZN18PrePostDollarFixerCERKS_((PrePostDollarFixer *) pfmt[0], "!!! ", " !!!");    pfmt[1] = malloc(sizeof(Multiplier));    _ZN20DefaultTextFormatterCEv((DefaultTextFormatter *) pfmt[1]);    ((Multiplier*)pfmt[1])->_times = 4;    ((TextFormatter*)pfmt[1])->vPtr = arrayOfVirtFunctionsStructMultiplier;    printf("--- Multiplier CTOR: times = %d\n", ((Multiplier*)pfmt[1])->_times);    pfmt[2] = malloc(sizeof(PrePostChecker));    _ZN14PrePostCheckerCEv((PrePostChecker *) pfmt[2]);    for (i = 0; i < 3; ++i)    {        ((typeFuncPrintPointerToChar)((((TextFormatter*)pfmt[i])->vPtr)[E_PrintEConst_char]))(pfmt[i], "Hello World!");    }    for (i = 2; i >= 0; --i)    {        ((typeDtor)(((TextFormatter*)&pfmt[i])->vPtr)[E_Dtor])(&pfmt[i]);        free(pfmt[i]);    }    printf("\n--- end doFormatterPtrs() ---\n\n");}void doFormatterDynamicArray(){    int i = 0;    DefaultTextFormatter* formatters;    printf("\n--- start doFormatterDynamicArray() ---\n\n");    formatters = _Z22generateFormatterArrayEv();    for (; i < 3; ++i)        _ZN13DefaultTextFormatter5printEc(formatters + i, "Hello World!");    for(i=2;i>=0;--i){        ((typeDtor)(((TextFormatter*)&formatters+i)->vPtr)[E_Dtor])(&formatters+i);    }    free(formatters);    printf("\n--- end doFormatterDynamicArray() ---\n\n");}int main(){    PrePostHashFixer hfix;    PrePostDollarFixer temp_hfix;     printf("\n--- Start main() ---\n\n");     doPrePostFixer();     doPrePostDollarFixer();     doPrePostChecker();     doPrePostFloatDollarFixer();     _ZN18PrePostHashFixerCEcc(&hfix, 4);     runAsPrePostFixerRef((PrePostFixer*)&hfix);     runAsPrePostDollarFixerRef((PrePostDollarFixer*)&hfix);     _ZN18PrePostDollarFixerCEPKcS(&temp_hfix, (PrePostDollarFixer*)&hfix);     runAsPrePostDollarFixerObj(temp_hfix);    ((typeDtor)(((TextFormatter*)&temp_hfix)->vPtr)[E_Dtor])(&temp_hfix);     runAsPrePostHashFixerRef(&hfix);    ((typeDtor)(((TextFormatter*)&hfix)->vPtr)[E_Dtor])(&hfix);    doMultiplier();    doFormatterArray();    doFormatterPtrs();    doFormatterDynamicArray();    printf("\n--- End main() ---\n\n");    return 0;}